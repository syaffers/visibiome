{% extends "job/job_base.html" %}
{% load static from staticfiles %}

{% block title %}Heatmap Visualization for Job #{{ job.id }}{% endblock %}
{% block job_page %}
  <h2>Heatmap</h2>
  <p>
    The heatmap enables user to view the non-phylogenetic (Bray-Curtis) distances for every
    possible pair of samples. This heatmap is generated with the 100 most similar representative
    samples from the reference database against the user submitted samples. The top 100 is picked
    by sorting the closest representatives for each sample and a union of the first samples.

  </p>
  <p>
    Consider three user-submitted samples: S1, S2, S3 and 5 representative samples R1, ..., R5
    which are matched with each sample at different distances. We order S1, S2 and S3 independently
    and pick the first representative from each group and iteratively (picking second closest
    representative from each sample in the next iteration, then third and so on) to fill a list of
    representative samples until we have 100 unique representative samples.

  </p>
  <p>
    The color gradient gives an idea as to the distance between the samples (white being the
    closest, blue being the farthest). Hover over the heatmap cells to get more information
    regarding the distance between the two corresponding samples.

  </p>

  <!-- Graph generated by heatmap.js -->
  <div id="legend"></div>
  <div class="plot-container">
    <div id="plot"></div>
    <div id="tooltip"></div>
  </div>
{% endblock %}

{% block lazy_js %}
<script src="{% static 'js/d3.v3.min.js' %}" type="text/javascript"></script>
<script src="{% static 'js/queue.v1.min.js' %}" type="text/javascript"></script>
<script src="{% static 'js/heatmap.js'%}" type="text/javascript"></script>
<script>
  var jobDir = "{{ job_dir }}";
  $(document).ready(function () {
    adjacency(jobDir);
  });
</script>
{% endblock %}

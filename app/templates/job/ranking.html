{% extends "job/job_base.html" %}
{% load staticfiles %}

{% block title %}OTU Rankings for Job #{{ job.id }}{% endblock %}
{% block job_page %}
  <h2>Ranking</h2>
  <p>
    The following visualizations are the top 20 most similar samples queried
    against the given user sample based on non-phylogenetic distance
    (Bray-Curtis). The <a href="#heatmap-section">Heatmap</a>,
    <a href="#dendrogram-section">Dendrogram</a> and
    <a href="#ranking-table-section">Ranking table</a>
    lists the similar samples, their distance(s), and sample details (metadata).

  </p>

  <!-- Graph generated by ranking.js -->

  <section id="heatmap-section">
    <div class="section-header">
      <div class="row">
        <div class="col-xs-10"><h3>Heatmap</h3></div>
        <div class="col-xs-2">
          <span class="back-to-top pull-right"><a href="#content-top">&uarr; Top</a></span>
        </div>
      </div>

    </div>
    <div id="heatmap"></div>
    <div id="legend"></div>
    <div id="tooltip-heatmap"></div>
  </section>

  <section id="dendrogram-section">
    <div class="section-header">
      <div class="row">
        <div class="col-xs-10"><h3>Dendrogram</h3></div>
        <div class="col-xs-2">
          <span class="back-to-top pull-right"></span><a href="#content-top">&uarr; Top</a>
        </div>
      </div>

    </div>
    <div id="dendrogram"></div>
    <div id="tooltip-dendrogram"></div>
  </section>

  <section id="ranking-table-section">
    <div class="section-header">
      <div class="row">
        <div class="col-xs-10"><h3>Ranking Table</h3></div>
        <div class="col-xs-2">
          <span class="back-to-top pull-right"><a href="#content-top">&uarr; Top</a></span>
        </div>
      </div>

    </div>
    <div id="ranking-table"></div>
  </section>
{% endblock %}

{% block lazy_js %}
<script src="http://d3js.org/d3.v3.min.js" type="text/JavaScript"></script>
<script src="http://d3js.org/queue.v1.min.js" type="text/javascript"></script>
<script src="{% static 'js/ranking.js'%}" type="text/javascript"></script>
<script>
  var dataPath = "{{data_path}}";
  $(document).ready(function () {
    adjacency(dataPath);
  });
</script>
{% endblock %}

{% extends "job/job_base.html" %}
{% load static from staticfiles %}

{% block title %}OTU Rankings for {{ job.name }}{% endblock %}
{% block job_page %}
  <h2>Ranking</h2>
  <p>
    The following ranking is based on the nearest samples in the ecosystem
    criteria selected during the search. Samples are ranked in order of
    closeness to individual samples in the submitted BIOM file. All information
    regarding the similar samples are listed along with the distance between
    the submitted sample and the queried samples.
  </p>

  <!-- Graph generated by ranking.js -->
  <section id="ranking-table-section">
    <div class="row">
      <div class="col-xs-12 col-sm-12">
        <ul class="nav nav-tabs" role="tablist">
          {% for sample in job.samples.all %}
            <li role="presentation">
              <a href="#sample-{{forloop.counter}}"
                 aria-controls="sample-{{forloop.counter}}"
                 role="tab" data-toggle="tab">{{sample.name}}</a>
            </li>
          {% endfor %}
        </ul>

        <div class="tab-content">
          {% for sample in job.samples.all %}
            <div role="tabpanel" class="tab-pane"
                 id="sample-{{forloop.counter}}">
              <div class="row">
                <div class="col-xs-12"
                     id="sample-{{forloop.counter}}-card-container">
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    </div>

  </section>
{% endblock %}

{% block lazy_js %}

<script src="{% static 'js/ranking.js'%}" type="text/javascript"></script>
<script>
  var jobSamplesRankingFile = "{{ ranking_file_path }}";
  var barchartFiles = "{{ barchart_files }}";
  var sampleIds = {{ samples|safe }};
  $(document).ready(function () {
    displayRankings(jobSamplesRankingFile, sampleIds, barchartFiles);
  });
</script>
{% endblock %}

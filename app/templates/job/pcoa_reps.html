{% extends "job/job_base.html" %}
{% load static from staticfiles %}

{% block title %}PCoA of Representative OTUs for {{ job.name }}{% endblock %}
{% block job_page %}
  <h2>PCoA Plot of Representative OTUs</h2>

  <p>
    The clusterability of the sample against the selected environments is
    confirmed by visually inspecting Principal Coordinate Analysis (PCoA) plots.
    The first option (default) of Ecosystem clusters samples on the basis of
    Ecosystem definition, while the second option clusters samples on the basis
    of EnvO(s). User Sample is given "Unknown" identity and can be easily
    identified by the black star symbol on the plot.
  </p>

  <h3>Interactivity</h3>
  <ul>
    <li>
      Hover mouse over points on the plots to view more information regarding
      the samples.
    </li>
    <li>
      To highlight certain sample ecosystems, click the legend box on the left
      hand side of the plots. Click again to unhighlight.
    </li>
    <li>
      To zoom in, click the magnifying glass symbol on the bottom-left-hand
      corner of a plot to activate zooming. Click again to inactivate and
      resume hovering.
    </li>
    <li>
      To move the plot, click the cross-arrows symbol on the bottom-left-hand
      corner of a plot to activate panning. Click again to inactivate and
      resume hovering.
    </li>
    <li>
      To reset the plot, click the home button on the bottom-left-hand corner
      of a plot.
    </li>
  </ul>

  <div class="btn-group" role="group">
    <button type="button" id="view-by-eco" class="active btn btn-primary">
      View by Ecosystem
    </button>
    <button type="button" id="view-by-envo" class="btn btn-primary">
      View by EnvO
    </button>
  </div>

  <!-- Graph generated by pcoa.js -->
  <div id="plots">
    <div id="ecosystem-plots">
      <h3>
        PC1 vs. PC2
        <!-- <a href="#" class="download-link btn btn-info btn-sm" data-plot="pcoa-pc1-pc2">
          <span class="glyphicon glyphicon-download"></span>
          Download
        </a> -->
      </h3>
      <div class="plot-container">
        <div id="pcoa-pc1-pc2-ecosystem" class="svg-container">
        </div>
      </div>
      <h3>
        PC1 vs. PC3
        <!-- <a href="#" class="download-link btn btn-info btn-sm" data-plot="pcoa-pc1-pc3">
          <span class="glyphicon glyphicon-download"></span>
          Download
        </a> -->
      </h3>
      <div class="plot-container">
        <div id="pcoa-pc1-pc3-ecosystem" class="svg-container"></div>
      </div>
      <h3>
        PC2 vs. PC3
        <!-- <a href="#" class="download-link btn btn-info btn-sm" data-plot="pcoa-pc2-pc3">
          <span class="glyphicon glyphicon-download"></span>
          Download
        </a> -->
      </h3>
      <div class="plot-container">
        <div id="pcoa-pc2-pc3-ecosystem" class="svg-container"></div>
      </div>
    </div>

    <div id="envo-plots">
      <h3>
        PC1 vs. PC2
        <!-- <a href="#" class="download-link btn btn-info btn-sm" data-plot="pcoa-pc1-pc2">
          <span class="glyphicon glyphicon-download"></span>
          Download
        </a> -->
      </h3>
      <div class="plot-container">
        <div id="pcoa-pc1-pc2-envo" class="svg-container">
        </div>
      </div>
      <h3>
        PC1 vs. PC3
        <!-- <a href="#" class="download-link btn btn-info btn-sm" data-plot="pcoa-pc1-pc3">
          <span class="glyphicon glyphicon-download"></span>
          Download
        </a> -->
      </h3>
      <div class="plot-container">
        <div id="pcoa-pc1-pc3-envo" class="svg-container"></div>
      </div>
      <h3>
        PC2 vs. PC3
        <!-- <a href="#" class="download-link btn btn-info btn-sm" data-plot="pcoa-pc2-pc3">
          <span class="glyphicon glyphicon-download"></span>
          Download
        </a> -->
      </h3>
      <div class="plot-container">
        <div id="pcoa-pc2-pc3-envo" class="svg-container"></div>
      </div>
    </div>

  </div>

{% endblock %}

{% block lazy_js %}
<script src="{% static 'js/d3.v3.min.js' %}" type="text/javascript"></script>
<script src="{% static 'js/mpld3.v0.3.js' %}" charset="utf-8"></script>
<script src="{% static 'js/pcoa.js' %}" type="text/javascript"></script>
<script>
  var pcoaFilePath = "{{ pcoa_file_path }}";
  $(document).ready(function () {
    startPcoa(pcoaFilePath);
  });
</script>
{% endblock %}
